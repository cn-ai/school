/***2018-08-16 10:28:11***/(function(e){function o(e,t){if(e.length==undefined)for(var n in e)t.call(e[n],e);else for(var n=0,r=e.length;n<r;n++)if(t.call(e[n],e)===!1)break}function u(e,t){var n=e,t=t||function(){};n&&n.match(".js")&&(n=n.split(".js")[0]);t.call(window,n)}function a(e,r){var i=e.deps,s=i.slice(0),o=r||function(){};(function f(e){u(e,function(e){e&&t[e]&&t[e].deps?a(t[e],function(){t[e].exports=t[e].factory.call()||"";n.push(t[e].exports);s.length==0?o.call():f(s.shift())}):s.length==0?o.call():f(s.shift())})})(s.shift());return n}function f(e,n){if(e){var i,o,u=e.factory,f=e.id;e.deps?i=a(e,function(){var i=[];for(var o=0,a=e.deps.length;o<a;o++)t[e.deps[o]]&&t[e.deps[o]].exports?i.push(t[e.deps[o]].exports):i;r.push(e.exports=u.apply(e,i));if(n){n.apply(e,r);s.modules=t}}):n?n.call():!0}else n?n.call():!0;return r}function l(e,n){var i=e.slice(0),s,o=n;(function a(e){u(e,function(e){f(t[e],function(){if(i.length==0){o&&o.apply(window,r);return}a(i.shift())})})})(i.shift())}var t={},n=[],r=[],i={},s={define:function(e,n,r){if(t[e])return!1;if(arguments.length>2)t[e]={id:e,deps:n,factory:r,exports:""};else{r=n;t[e]={id:e,factory:r};t[e].exports=r.call(window)||""}},require:function(e,n){if(Object.prototype.toString.call(e)==="[object Array]"){if(e.length>1)return l(e,n);if(e.length==0){n.call();return!0}e=e[0];u(e,function(r){if(!t[r]){n.call();return!0}if(n){var i=f(t[r],n);return i}return t[e].factory?f(t[r]):t[r].exports})}}};window.exmodules=t;if(typeof module=="object"&&typeof require=="function"){module.exports.require=s.require;module.exports.define=s.define}else{e.require=s.require;e.define=s.define}})(window);Function.prototype.bind=Function.prototype.bind||function(e){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&e?this:e||window,t.concat(Array.prototype.slice.call(arguments)))};r.prototype=this.prototype;i.prototype=new r;return i};define("consumer/Public/core",[],function(){var e=function(){var e=function(){};e.add=function(){this.bindEvents.apply(this,arguments)};e.bindEvents=function(e,t,n){if(arguments.length==3){var r=/^(\S+)\s*(.*)$/,i,s,o;i=e.match(r);s=i[1];o=i[2];LJ.$(document).on(s,o,function(e){var r=e||window.event,i=r.target||r.srcElement;t.call(n,i,r)})}else{var u=Array.prototype.slice.call(arguments);LJ.$(u[1]).bind(u[0],function(e){var t=e||window.event,n=t.target||t.srcElement;u[2].call(u[3],n,t)})}};e.pcFormCheck={types:{},errMsg:[],check:function(e,t,n){var r=this,i=[],s=[],o=!0;this.errMsg=[];LJ.forEach(t,function(t,n){if(!r.types[n])throw{name:"validation error",message:"no types"};i.push(r.types[n].validate(e));r.types[n].validate(e)||r.errMsg.push(r.types[n].errMessage)});LJ.forEach(i,function(e,t){t||(o=!1)});if(o)return!0;n(this.errMsg);return!1}};e.wordRule={callback:[],scoreArr:[],loopIndex:0,add:function(e,t){this.callback.push(e);this.scoreArr.push(t)},start:function(e,t,n){var r=arguments.callee;task=this.callback[this.loopIndex],curscore=this.scoreArr[this.loopIndex];task(e)&&(t+=curscore);if(this.loopIndex<this.callback.length-1){++this.loopIndex;r.call(this,e,t,n)}else{this.loopIndex=0;n(t)}}};var t={secretMethod:function(e){var t=new Base64,n=hex_md5(e),r=t.encode(e);return t.encode(n.substr(0,8)+r+n.substr(10,4))},decodeMethod:function(e){var t=new Base64,n=t.decode(e).length;return t.decode(t.decode(e).substr(8,n-12))},loadImage:function(e,t){var n=new Image;n.src=e;if(n.complete){t.call(null,n);return}n.onload=function(){t.call(null,n);n=n.onload=null}},loadScript:function(e,t,n){var r=document.createElement("script");r.type="text/javascript";if(n&&!/[&?]callback=/.test(e)&&typeof t=="function"){var i="sso_success"+ +(new Date)+Math.round(Math.random()*1e3);window[i]=t;t=null;e+=/\?/.test(e)?"&":"?";e+="callback="+i}r.readyState?r.onreadystatechange=function(){if(r.readyState=="loaded"||r.readyState=="complete"){r.onreadystatechange=null;t&&t();r.parentNode.removeChild(r)}}:r.onload=function(){t&&t();r.parentNode.removeChild(r)};r.src=e;document.getElementsByTagName("head")[0].appendChild(r)},setCookie:function(e,t,n,r){if(n){var i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3);var s="; expires="+i.toGMTString()}else var s="";var o=e+"="+t+s+"; path=/"+(r?"; domain="+r:"");document.cookie=o},getCookie:function(e){var t=document.cookie.match(new RegExp("\\b"+e+"=([^;]+)"));return t?t[1]:""},getDays:function(e,t){e=e||(new Date).getFullYear();var n=0;t==2?e%4==0&&e%100!=0||e%400==0?n=29:n=28:t=="01"||t=="03"||t=="05"||t=="07"||t=="08"||t=="10"||t=="12"?n=31:n=t?30:1;return n},compareTime:function(e,t,n){var r,i=e.split("-")[0],s=t.split("-")[0],o=(new Date("2015-"+e)).getTime(),u=(new Date("2015-"+t)).getTime();switch(n){case">=":s==="01"&&i==="12"&&(u=(new Date("2016-"+t)).getTime());return u>=o;break;case"<=":s==="12"&&i==="01"&&(o=(new Date("2016-"+e)).getTime());return u<=o;break;case"=":return u==o}},serializeArray:function(e){var t=Array.prototype.slice.call(e.elements),n=[],r=["checkbox","radio"];LJ.forEach(t,function(e,t){var i=!!t.value&&"";t.name&&!t.disabled&&(r.indexOf(t.type)>0?this.checked&&n.push({name:t.name,value:t.value}):n.push({name:t.name,value:t.value}))});return n},getJson:function(e){var t={};LJ.forEach(e,function(){if(t[this.name]!==undefined){LJ.type(t[this.name])!=="array"&&(t[this.name]=[t[this.name]]);t[this.name].push(this.value||"")}else t[this.name]=this.value||""});return t},checkRepeat:function(e){var t=e.split("");obj={},index=0;LJ.forEach(t,function(e,n){n in obj?n==t[e-1]&&e>0&&obj[n].push(n):obj[n]=[n]});LJ.forEach(obj,function(e,t){t.length>1&&(index+=t.length-1)});return index},isplace:function(){var e="placeholder"in document.createElement("input");return function(t){if(e)return;LJ.forEach(LJ.$("."+t),function(e,t){var n=this,r=this.getAttribute("placeholder");this.value===""&&(this.value=r);LJ.$(this).bind("focus",function(){n.value===r&&(n.value="")});LJ.$(this).bind("blur",function(){n.value===""&&(n.value=r)})})}}(),preventShake:function(e,t,n){var r=null;return function(){var t=t==undefined?null:t,i=arguments;clearTimeout(r);r=setTimeout(function(){r=null;e.apply(t,i)},n?n:1e3)}}};return{GeneralP:e,Util:t}}();return e});require(["consumer/Public/core"],function(General){function APIs(){}function Register(){this.init.apply(this,arguments)}var checkValidate={isOk:!1,insertRule:function(){General.GeneralP.pcFormCheck.types.isPhone={validate:function(e){return/^(0|86|17951)?(13[0-9]|15[012356789]|17[0-9]|18[0-9]|14[57]|16[0-9]|19[0-9])[0-9]{8}$/.test(e)},errMessage:"您输入的手机号码有误，请重新输入！"};General.GeneralP.pcFormCheck.types.isDm={validate:function(e){return/(^(0|86|17951)?(13[0-9]|15[012356789]|17[0-9]|18[0-9]|14[57])[0-9]{8}$)|(^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+)/.test(e)},errMessage:"手机号码或邮箱输入有误，请重新输入！"};General.GeneralP.pcFormCheck.types.yzNotnull={validate:function(e){return e.length!==0},errMessage:"验证码不能为空！"};General.GeneralP.pcFormCheck.types.passNotnull={validate:function(e){return e.length!==0},errMessage:"登录密码不能为空！"}},resultSuccess:function(e,t,n,r){var i=this;this.isOk=General.GeneralP.pcFormCheck.check(n,[e],function(e){i.insertErr(e,t)});this.isOk&&(LJ.$("."+t)[0].innerHTML="");r(this.isOk)},insertErr:function(e,t){LJ.$("."+t)[0].innerHTML=e}};APIs.prototype={constructor:APIs,getSaoma:function(){this.url="/web/sso/SsoSendCode";this.type="GET"},checkCode:function(){this.url="/web/sso/checkMCode";this.type="GET"},checkMobile:function(){this.url="/Settings/Findpwd/isReg";this.type="GET"},checkPass:function(){this.url="/Settings/Findpwd/checkPwd";this.type="GET"},checkImg:function(){this.url="/Settings/Findpwd/checkImageCode";this.type="GET"},optWhich:function(e){this[e].call(this)}};Register.prototype={constructor:Register,init:function(){General.Util.isplace("placeholder");this.curIndex=1;this.setKey();this.addEvents();checkValidate.insertRule()},addEvents:function(){var e=this;General.GeneralP.add("click .loginTab a",this.tabChange,this);General.GeneralP.add("blur",".loginText",this.loginRule,this);General.GeneralP.add("blur",".mailText",this.mobileReg,this);General.GeneralP.add("click .num",this.getSaoma,this);General.GeneralP.add("click .sBtn03",this.submitBtn,this);LJ.$(document).bind("keydown",function(t){var n=t||window.event,r=n.keyCode?n.keyCode:n.which;r===13&&LJ.$(".sBtn03")[e.curIndex].click()});LJ.$(".closeGuide")[0].length!==0&&General.GeneralP.add("click .closeGuide",this.closePop,this)},tabChange:function(e){LJ.$(e).parent().addClass("cur");LJ.$(e).parent().siblings().removeClass("cur");LJ.$("."+e.getAttribute("data-target")).css("display","block");LJ.$("."+LJ.$(e).parent().siblings().children()[0].getAttribute("data-target")).css("display","none");e.getAttribute("data-target")==="phoneLogin"?this.curIndex=0:this.curIndex=1},closePop:function(){LJ.$(".sGuidePage").css("display","none");LJ.$(".guideImg").css("display","none")},setKey:function(e){var t;if(document.referrer){var n=document.referrer.replace(/(^(http||https)\:\/\/[^\/]+)(\/.+)/,"$1");t=General.Util.secretMethod(n)}else t=General.Util.secretMethod(window.location.protocol+"//"+document.domain);e&&e.call(this,t)},isEmail:function(e){return~e.search(/@/)},getSaoma:function(){var e=!1;return function(t){if(!e){e=!0;var n=this,r=LJ.trim(LJ.$(".dyzText")[0].value),i=60,s;this.loginRule(LJ.$(".numText")[0])?this.checkIcode(r,function(){var n=new APIs,r=General.Util.secretMethod(LJ.trim(LJ.$(".numText")[0].value));n.optWhich("getSaoma");LJ.ajax({url:n.url,method:n.type,data:{mobile:r,codetype:0},completeListener:function(){}});LJ.$(t).addClass("again");t.innerHTML="重新发送"+i+"秒";s=setInterval(function(){if(i===0){clearInterval(s);LJ.$(t).removeClass("again");e=!1;t.innerHTML="获取动态密码"}else{i--;t.innerHTML="重新发送"+i+"秒"}},1e3)},function(){e=!1}):e=!1}}}(),loginRule:function(e){var t=!0;if(e.getAttribute("data-rule")){var n=e.getAttribute("data-rule").split(","),r=LJ.trim(e.value);checkValidate.resultSuccess(n[0],n[1],r,function(n){LJ.$(e).next().css("display","block");LJ.$(e).next()[0].className=n?"right":"error";t=n?!0:!1});return t}},mobileReg:function(e){var t=General.Util.secretMethod(LJ.trim(e.value));this.loginRule(e)&&this.checkReg(t)},checkIcode:function(imageCode,cb,fail){var _this=this,api=new APIs;api.optWhich("checkImg");this.loginRule(LJ.$(".dyzText")[0])?LJ.ajax({url:api.url,method:api.type,dataType:"json",data:{imageCode:imageCode,mobile:LJ.trim(LJ.$(".numText")[0].value)},completeListener:function(data){var target=eval("("+this.responseText+")");LJ.$(".dyzText").next().css("display","block");if(+target.code===0){LJ.$(".dyzText").next()[0].className="right";LJ.$(".dyzError")[0].innerHTML="";cb&&cb.call(_this)}else{LJ.$(".dyzText").next()[0].className="error";LJ.$(".dyzError")[0].innerHTML="验证码输入有误，请重新输入！";fail&&fail.call(_this)}}}):fail&&fail.call(_this)},checkReg:function(mobileVal,cb){var _this=this,orval=LJ.trim(LJ.$(".mailText")[0].value),data={},api=new APIs;api.optWhich("checkMobile");data[this.isEmail(orval)?"email":"mobile"]=mobileVal;LJ.ajax({url:api.url,method:api.type,data:data,completeListener:function(){LJ.$(".mailText").next().css("display","block");var target=eval("("+this.responseText+")");if(+target.code===0){LJ.$(".dmError")[0].innerHTML="";LJ.$(".mailText").next()[0].className="right";return cb&&cb(!0)}LJ.$(".dmError")[0].innerHTML=_this.isEmail(orval)?"邮箱未注册，请重新输入！":"手机号码未注册，请重新输入！";LJ.$(".mailText").next()[0].className="error";return cb&&cb(!1)}})},submitBtn:function(el){var _this=this,handleFn={messageBtn:function(){var dyzText=LJ.trim(LJ.$(".dyzText")[0].value);checkValidate.resultSuccess("isPhone","mobileError",LJ.$(".numText")[0].value,function(result){LJ.$(".numText").next().css("display","block");LJ.$(".numText").next()[0].className=result?"right":"error";result&&_this.checkIcode(dyzText,function(){var api=new APIs,mobileVal=General.Util.secretMethod(LJ.trim(LJ.$(".numText")[0].value)),codeVal=LJ.trim(LJ.$(".codeText")[0].value);api.optWhich("checkCode");LJ.ajax({url:api.url,method:api.type,dataType:"json",data:{mobile:mobileVal,code:codeVal},completeListener:function(data){var target=eval("("+this.responseText+")"),dyzVal=LJ.trim(LJ.$(".dyzText")[0].value);LJ.$(".codeText").next().css("display","block");LJ.$(".setMobile")[0].value=mobileVal;LJ.$(".setCode")[0].value=codeVal;LJ.$(".dynamicYzm")[0].value=dyzText;if(+target.code===0){LJ.$(".trendError")[0].innerHTML="";LJ.$(".codeText").next()[0].className="right";if(+target.errorNum<3){document.forms.msgForm.submit();return!1}}else{LJ.$(".trendError")[0].innerHTML="动态密码输入有误，请重新输入！";LJ.$(".codeText").next()[0].className="error"}if(!(+target.errorNum>=5)){+target.code===0&&document.forms.msgForm.submit();return!1}LJ.$(".dyzText").next()[0].className="error";LJ.$(".trendError")[0].innerHTML="";LJ.$(".dyzError")[0].innerHTML="请6个小时之后再登录"}})})})},accountBtn:function(){var e=LJ.$(".accountImg").css("display"),t=e==="none"?2:3,n=[LJ.$(".mailText")[0],LJ.$(".passText")[0],LJ.$(".ayzText")[0]],r=0;e==="none"&&n.splice(2,1);LJ.forEach(n,function(e,t){_this.loginRule(t,!0)&&++r});if(r===t){var i=General.Util.secretMethod(LJ.trim(LJ.$(".mailText")[0].value)),s=General.Util.secretMethod(LJ.trim(LJ.$(".passText")[0].value)),o=LJ.trim(LJ.$(".ayzText")[0].value);e!=="none"?this.accountLogin(i,s,function(){this.sendCode(o,i,s)}):this.accountLogin(i,s)}},sendCode:function(val,mobileVal,passVal){var api=new APIs,orval=LJ.trim(LJ.$(".mailText")[0].value);api.optWhich("checkImg");LJ.ajax({url:api.url,method:api.type,dataType:"json",data:{imageCode:val},completeListener:function(data){var target=eval("("+this.responseText+")");LJ.$(".ayzText").next().css("display","block");if(+target.code===0){LJ.$(".ayzText").next()[0].className="right";LJ.$(".ayzError")[0].innerHTML="";LJ.$(".passText").next().css("display","none");LJ.$(".passwordError")[0].innerHTML="";LJ.$(".passText").next()[0].className="right";LJ.$(".setMail")[0].setAttribute("name",_this.isEmail(orval)?"email":"mobile");LJ.$(".setMail")[0].value=mobileVal;LJ.$(".setWord")[0].value=passVal;LJ.$(".accountYzm")[0].value=val;LJ.$(".accountYzm")[0].removeAttribute("disabled");document.forms.accountForm.submit();return!1}LJ.$(".ayzText").next()[0].className="error";LJ.$(".ayzError")[0].innerHTML="验证码输入有误，请重新输入！"}})},accountLogin:function(mobileVal,passVal,fn){var that=this,data={oldPwd:passVal},orval=LJ.trim(LJ.$(".mailText")[0].value),api=new APIs;api.optWhich("checkPass");data[_this.isEmail(orval)?"email":"mobile"]=mobileVal;_this.checkReg(mobileVal,function(status){status&&LJ.ajax({url:api.url,method:api.type,data:data,completeListener:function(dataWord){var target=eval("("+this.responseText+")"),imgShow=LJ.$(".accountImg").css("display");if(+target.code===0){if(fn&&LJ.type(fn)==="function")fn.call(that);else if(+target.errorNum<3){LJ.$(".passText").next().css("display","none");LJ.$(".passwordError")[0].innerHTML="";LJ.$(".passText").next()[0].className="right";LJ.$(".setMail")[0].setAttribute("name",_this.isEmail(orval)?"email":"mobile");LJ.$(".setMail")[0].value=mobileVal;LJ.$(".setWord")[0].value=passVal;document.forms.accountForm.submit();return!1}}else{LJ.$(".passText").next().css("display","block");LJ.$(".passwordError")[0].innerHTML="登录密码输入有误，请重新输入！";LJ.$(".passText").next()[0].className="error"}if(+target.errorNum>=3)if(imgShow==="none"){LJ.$(".accountImg").css("display","block");LJ.$(".accoutLogin").removeClass("dxkj_login").addClass("zhdl_login")}else if(target.errorNum>=5){LJ.$(".ayzText").next()[0].className="error";LJ.$(".passwordError")[0].innerHTML="";LJ.$(".dmError")[0].innerHTML="";LJ.$(".ayzError")[0].innerHTML="请6个小时之后再登录"}else+target.code===0&&fn.call(that)}})})}};handleFn[LJ.$(el)[0].getAttribute("data-fn")]()}};new Register});